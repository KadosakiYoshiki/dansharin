<% if user_signed_in? %> <!-- ユーザーがログインしているか調べる -->
  <div class="row">
    <div class="col-md-4">
      <div class="d-flex justify-content-between">
        <div>
          <% if current_user.profile_image.attached? && current_user.profile_image_exists? %>
            <%= image_tag current_user.image_url(:ogp), class: "img-thumbnail img-responsive" %>
          <% else %>
            <i class="bi-person-fill img-thumbnail img-responsive" style="font-size: 2rem; color: cornflowerblue;"　></i>
          <% end %>
        </div>
      </div>
      <div>
        <span class="fw-bold"><%= current_user.nickname %></span>
      </div>
      <div>
        @<%= current_user.username %>
      </div>
      <div>
        <%= User.human_attribute_name(:description) %>
        <%= simple_format current_user.description %>
      </div>
    </div>
    <div class="col-md-8">
      <% @posts.each do |post| %>
        <div class="border mb-2 p-1">
          <div class="d-flex">
            <div class="flex-shrink-1 me-1" style="width: 70px; height: 70px;">
              <% if post.user.profile_image.attached? && post.user.profile_image_exists? %>
                <%= image_tag post.user.image_url(:ogp), class: "img-thumbnail img-responsive" %>
              <% else %>
                <i class="bi-person-fill img-thumbnail img-responsive" style="font-size: 2rem; color: cornflowerblue;" class=""></i>
              <% end %>
            </div>
            <div class="w-100">
              <div class="d-flex justify-content-between">
                <div class="d-flex justify-content-start">
                  <div class="me-1">
                    <span class="fw-bold"><%= post.user.nickname %></span>
                  </div>
                  <div class="me-1">
                    <%= '@' + post.user.username %>
                  </div>
                  <div class="me-1">
                    ・ <i class="bi-alarm"></i> <%= time_ago_in_words(post.created_at) %>
                  </div>
                </div>
                <% if current_user == post.user %>
                  <div class="me-1">
                    <a href="#" id="post_<%= post.id %>" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class="bi-three-dots" style="color: gray;"></i> 
                    </a>
                    <div class="dropdown-menu" aria-labelledby="post_<%= post.id %>">
                      <%= button_to "投稿を削除", post_path(post, path: request.fullpath), method: :delete, data: { turbo_confirm: '削除しますか？' }, class: "dropdown-item" %>
                    </div>
                  </div>
                <% end %>
              </div>
              <div><%= simple_format post.content %></div>
              <% if post.post_images.attached? %>
                <div>
                  <% post.post_images.each do |image| %>
                    <%= image_tag image.variant(resize: 0.3) %>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% else %>
  <!-- ユーザーがログインしていなかった時の処理 -->
  <h2> 現在ログインしていません </h2>
  <%= link_to "ログイン", new_user_session_path, class: 'post' %> <!-- ログイン画面に移行する -->
  <%= link_to "新規登録", new_user_registration_path, class: 'post' %> <!-- 新規登録画面に移行する -->
<% end %>